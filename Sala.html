<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reserva de Salas - Multiusuário</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;font-family:'Roboto',sans-serif;margin:0;padding:0;}
body{background:radial-gradient(circle at top,#1a1a2e,#0f0f17);color:#f0f0f0;min-height:100vh;display:flex;justify-content:center;align-items:flex-start;padding:40px;}
.container{background:rgba(44,44,60,0.9);padding:30px;border-radius:15px;box-shadow:0 0 25px rgba(0,255,255,0.2);width:400px;backdrop-filter:blur(10px);position:relative;}
h2{text-align:center;margin-bottom:20px;color:#00e6e6;text-shadow:0 0 8px #00e6e6,0 0 15px #008b8b;}
input,textarea,button,select{width:100%;padding:10px;margin-bottom:15px;border-radius:10px;border:none;outline:none;font-size:14px;transition:0.3s;box-shadow:inset 0 0 8px rgba(0,255,255,0.1);}
input:focus,textarea:focus,select:focus{box-shadow:0 0 12px #00e6e6,inset 0 0 8px #00e6e6;transform:scale(1.02);}
input[readonly]{background:#e0fafa;cursor:pointer;font-weight:bold;}
textarea{resize:none;height:80px;}
button{background:linear-gradient(135deg,#00e6e6,#00b3b3);color:#000;font-weight:bold;font-size:16px;cursor:pointer;transition:0.3s;box-shadow:0 0 10px #00e6e6;}
button:hover{background:linear-gradient(135deg,#00ffff,#00b3b3);color:#fff;transform:scale(1.05) translateY(-2px);box-shadow:0 0 18px #00ffff;}
.modal{display:none;position:fixed;z-index:100;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.85);justify-content:center;align-items:center;}
.modal-content{background:rgba(44,44,60,0.95);padding:25px;border-radius:15px;max-width:600px;width:90%;text-align:center;box-shadow:0 0 25px rgba(0,255,255,0.3);border:1px solid rgba(0,255,255,0.2);animation:fadeIn 0.4s ease;}
@keyframes fadeIn{from{opacity:0;transform:scale(0.9);}to{opacity:1;transform:scale(1);}}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:10px;margin-top:20px;}
.day{padding:15px;border-radius:10px;font-weight:bold;cursor:pointer;transition:0.2s;box-shadow:0 0 10px rgba(0,255,255,0.1);}
.day.available{background:#28a745;color:#fff;box-shadow:0 0 10px rgba(40,167,69,0.6);}
.day.unavailable{background:#dc3545;color:#fff;cursor:not-allowed;box-shadow:0 0 10px rgba(220,53,69,0.6);}
.day.selected{background:#00e6e6;color:#000;box-shadow:0 0 15px #00e6e6;}
.day.available:hover{transform:translateY(-3px) scale(1.05);box-shadow:0 0 20px rgba(0,255,0,0.8);}
.legend{display:flex;justify-content:center;gap:20px;margin-top:15px;}
.legend div{display:flex;align-items:center;gap:5px;}
.legend span{width:20px;height:20px;display:inline-block;border-radius:4px;}
.available span{background:#28a745;}
.unavailable span{background:#dc3545;}
.selected span{background:#00e6e6;}
.close-btn{background:#dc3545;color:#fff;padding:10px 20px;border-radius:10px;cursor:pointer;font-weight:bold;margin-top:15px;transition:0.3s;box-shadow:0 0 10px rgba(255,0,0,0.5);}
.close-btn:hover{background:#ff4d4d;transform:scale(1.05);box-shadow:0 0 18px rgba(255,0,0,0.8);}
#userInfo{text-align:right;font-weight:bold;margin-bottom:10px;color:#00e6e6;}
#btnLogout{display:block;width:100%;background:#ff4d4d !important;color:#fff !important;font-weight:bold;padding:10px;border-radius:10px;margin-bottom:15px;cursor:pointer;box-shadow:0 0 15px rgba(255,0,0,0.5);transition:0.3s;}
#btnLogout:hover{background:#dc3545 !important;transform:scale(1.05);box-shadow:0 0 20px rgba(255,0,0,0.8);}
#btnCadastroModal{background:#00b3ff;color:#fff;padding:10px;border-radius:10px;cursor:pointer;margin-bottom:15px;font-weight:bold;box-shadow:0 0 10px rgba(0,179,255,0.5);}
#btnCadastroModal:hover{background:#0080cc;transform:scale(1.05);box-shadow:0 0 18px rgba(0,128,204,0.8);}
#listaReservas{list-style:none;padding:0;max-height:250px;overflow-y:auto;}
#listaReservas li{background: rgba(0,230,230,0.1); padding: 8px 12px; margin-bottom: 6px; border-radius: 8px; box-shadow: 0 0 8px rgba(0,230,230,0.4); display:flex; justify-content:space-between; align-items:center;}
#listaReservas li:hover{background: rgba(0,230,230,0.2); box-shadow:0 0 12px rgba(0,230,230,0.6);}
.remove-btn{background:#dc3545;color:#fff;border:none;padding:4px 8px;border-radius:5px;cursor:pointer;font-size:12px;}
.remove-btn:hover{background:#ff4d4d;}
</style>
</head>
<body>

<!-- Login -->
<div class="container" id="loginContainer">
    <h2>Login</h2>
    <input type="text" id="userLogin" placeholder="Usuário">
    <input type="password" id="passLogin" placeholder="Senha">
    <select id="tipoUsuario">
        <option value="usuario">Usuário</option>
        <option value="adm">Administrador</option>
    </select>
    <button id="btnLogin">Entrar</button>
    <button id="btnCadastroModal">Cadastrar Novo Usuário</button>
</div>

<!-- Tela Usuário -->
<div class="container" id="reservaContainer" style="display:none;">
    <div id="userInfo"></div>
    <button id="btnLogout">Logout</button>

    <!-- Conteúdo Dinâmico -->
    <div id="telaUsuario" style="display:none;">
        <h2>Reservar Sala</h2>
        <label>Selecione os dias:</label>
        <input type="text" id="diasSelecionados" readonly placeholder="Clique para escolher os dias">
        <label for="observacoes">Observações:</label>
        <textarea id="observacoes" placeholder="Observações"></textarea>
        <button id="btnReservar">Reservar</button>
    </div>

    <div id="telaAdmin" style="display:none;">
        <h2>Administração de Reservas</h2>
        <ul id="listaReservas"></ul>
        <button id="btnLiberar">Liberar todos os dias</button>
    </div>
</div>

<!-- Modal Calendário -->
<div class="modal" id="modalCalendar">
    <div class="modal-content">
        <h2>Selecione os Dias</h2>
        <div class="calendar" id="calendar"></div>
        <div class="legend">
            <div class="available"><span></span>Disponível</div>
            <div class="unavailable"><span></span>Indisponível</div>
            <div class="selected"><span></span>Selecionado</div>
        </div>
        <div class="close-btn" id="closeModal">Fechar</div>
    </div>
</div>

<!-- Modal Cadastro -->
<div class="modal" id="modalCadastro">
    <div class="modal-content">
        <h2>Cadastrar Novo Usuário</h2>
        <input type="text" id="novoUser" placeholder="Nome de usuário">
        <input type="password" id="novaSenha" placeholder="Senha">
        <select id="novoTipoUsuario">
            <option value="usuario">Usuário</option>
            <option value="adm">Administrador</option>
        </select>
        <button id="btnCriarUsuario">Cadastrar</button>
        <div class="close-btn" id="closeCadastro">Fechar</div>
    </div>
</div>

<script>
// Inicialização
let usuarios = JSON.parse(localStorage.getItem('usuarios')) || [
    {user:"user", pass:"123", tipo:"usuario"},
    {user:"admin", pass:"1234", tipo:"adm"}
];
let reservas = JSON.parse(localStorage.getItem('reservas')) || [];
let diasSelecionados = [];
let usuarioAtual = null;

// Elementos
const loginContainer = document.getElementById('loginContainer');
const reservaContainer = document.getElementById('reservaContainer');
const telaUsuario = document.getElementById('telaUsuario');
const telaAdmin = document.getElementById('telaAdmin');
const adminControls = document.getElementById('adminControls');
const userInfo = document.getElementById('userInfo');
const diasInput = document.getElementById('diasSelecionados');
const modal = document.getElementById('modalCalendar');
const calendarDiv = document.getElementById('calendar');
const lista = document.getElementById('listaReservas');
const modalCadastro = document.getElementById('modalCadastro');

function salvarReservas(){ localStorage.setItem('reservas', JSON.stringify(reservas)); }
function salvarUsuarios(){ localStorage.setItem('usuarios', JSON.stringify(usuarios)); }

function formatarData(dataStr){
    const meses = ["Janeiro","Fevereiro","Março","Abril","Maio","Junho",
                   "Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];
    const partes = dataStr.split('-');
    const dia = partes[2]; const mes = meses[parseInt(partes[1])-1]; const ano = partes[0];
    return `${dia} de ${mes} de ${ano}`;
}

// Atualiza lista admin
function atualizarLista(){
    lista.innerHTML='';
    reservas.sort().forEach(r=>{
        const li = document.createElement('li');
        li.textContent = `${formatarData(r.data)} - ${r.user}`;
        const removeBtn = document.createElement('button');
        removeBtn.textContent='Liberar';
        removeBtn.classList.add('remove-btn');
        removeBtn.addEventListener('click', ()=>{
            reservas = reservas.filter(x=>x!==r);
            salvarReservas();
            atualizarLista();
        });
        li.appendChild(removeBtn);
        lista.appendChild(li);
    });
}

// Calendário
function openCalendar(){ diasSelecionados=[]; modal.style.display='flex'; renderCalendar(); }
function renderCalendar(){
    calendarDiv.innerHTML='';
    const hoje = new Date();
    const diasNoMes = new Date(hoje.getFullYear(), hoje.getMonth()+1,0).getDate();
    for(let i=1;i<=diasNoMes;i++){
        const dataAtual = new Date(hoje.getFullYear(), hoje.getMonth(), i);
        const dataString = dataAtual.toISOString().split('T')[0];
        const dayDiv = document.createElement('div');
        dayDiv.classList.add('day'); dayDiv.textContent=i;
        if(reservas.find(r=>r.data===dataString)){ dayDiv.classList.add('unavailable'); }
        else { dayDiv.classList.add('available'); dayDiv.addEventListener('click', ()=>{
            if(diasSelecionados.includes(dataString)) diasSelecionados = diasSelecionados.filter(d=>d!==dataString);
            else diasSelecionados.push(dataString);
            renderCalendar();
        });}
        if(diasSelecionados.includes(dataString)) dayDiv.classList.add('selected');
        calendarDiv.appendChild(dayDiv);
    }
}

// Eventos
diasInput.addEventListener('click', openCalendar);
document.getElementById('closeModal').addEventListener('click', ()=>{
    modal.style.display='none';
    diasInput.value = diasSelecionados.map(formatarData).join(', ');
});

document.getElementById('btnReservar').addEventListener('click', ()=>{
    if(diasSelecionados.length===0){ alert('Selecione pelo menos um dia'); return; }
    diasSelecionados.forEach(d=>{
        reservas.push({data:d,user:usuarioAtual.user});
    });
    salvarReservas();
    diasSelecionados=[]; diasInput.value='';
    alert('Reserva efetuada com sucesso!');
});

document.getElementById('btnLiberar').addEventListener('click', ()=>{
    if(confirm('Deseja liberar todas as reservas?')){
        reservas=[]; salvarReservas(); atualizarLista();
    }
});

// Logout
document.getElementById('btnLogout').addEventListener('click', ()=>{
    usuarioAtual=null;
    loginContainer.style.display='block';
    reservaContainer.style.display='none';
    telaUsuario.style.display='none';
    telaAdmin.style.display='none';
    userInfo.textContent='';
});

// Login
document.getElementById('btnLogin').addEventListener('click', ()=>{
    const user = document.getElementById('userLogin').value;
    const pass = document.getElementById('passLogin').value;
    const tipo = document.getElementById('tipoUsuario').value;
    const found = usuarios.find(u=>u.user===user && u.pass===pass && u.tipo===tipo);
    if(found){
        usuarioAtual=found;
        loginContainer.style.display='none';
        reservaContainer.style.display='block';
        userInfo.textContent=`Logado como: ${usuarioAtual.user} (${usuarioAtual.tipo})`;
        if(usuarioAtual.tipo==="usuario"){ telaUsuario.style.display='block'; telaAdmin.style.display='none'; }
        else{ telaUsuario.style.display='none'; telaAdmin.style.display='block'; atualizarLista(); }
    } else alert('Usuário ou senha incorretos!');
});

// Abrir modal cadastro
document.getElementById('btnCadastroModal').addEventListener('click', ()=> modalCadastro.style.display='flex');
document.getElementById('closeCadastro').addEventListener('click', ()=> modalCadastro.style.display='none');

// Criar usuário
document.getElementById('btnCriarUsuario').addEventListener('click', ()=>{
    const novoUser=document.getElementById('novoUser').value.trim();
    const novaSenha=document.getElementById('novaSenha').value.trim();
    const novoTipo=document.getElementById('novoTipoUsuario').value;
    if(!novoUser || !novaSenha){ alert('Preencha todos os campos'); return; }
    if(usuarios.some(u=>u.user===novoUser)){ alert('Usuário já existe!'); return; }
    usuarios.push({user:novoUser,pass:novaSenha,tipo:novoTipo});
    salvarUsuarios();
    alert('Usuário criado com sucesso!');
    modalCadastro.style.display='none';
    document.getElementById('novoUser').value=''; document.getElementById('novaSenha').value='';
});
</script>

</body>
</html>
